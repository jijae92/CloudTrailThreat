"""Tests for the env_secret rule stub."""
from __future__ import annotations

from pathlib import Path

from scanner.rules import env_secret


def test_env_secret_detects_literal() -> None:
    source = Path(__file__).resolve().parents[1] / "functions" / "vulnerable" / "app.py"
    findings = env_secret.scan(source_path=str(source))
    assert findings, "Expected findings for hardcoded secrets"
    assert findings[0].severity.name == "HIGH"
